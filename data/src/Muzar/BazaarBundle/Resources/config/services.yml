parameters:


services:

    muzar_bazaar.query_suggester:
        class: Muzar\BazaarBundle\Suggestion\ElasticaQuerySuggester
        arguments: [@fos_elastica.client.default, 'website', 'query']


    muzar_bazaar.watchdog:
        class: Muzar\BazaarBundle\Watchdog
        arguments: [@fos_elastica.index, @doctrine.orm.entity_manager]

    muzar_bazaar.model.entity_listener.category:
        class: Muzar\BazaarBundle\Entity\CategoryListener
        arguments: [@muzar_bazaar.nsm.category]

    muzar_bazaar.model.entity_listener.item_search_query:
        class: Muzar\BazaarBundle\Entity\ItemSearchQueryListener
        arguments: [@muzar_bazaar.watchdog]

    muzar_bazaar.nsm.category.config:
        class: DoctrineExtensions\NestedSet\Config
        arguments: [@doctrine.orm.entity_manager, Muzar\BazaarBundle\Entity\Category]
        calls:
            - [setRootFieldName, [null]]



    muzar_bazaar.nsm.category:
        class: DoctrineExtensions\NestedSet\Manager
        arguments: [@muzar_bazaar.nsm.category.config]



    muzar_bazaar.model_service.item:
        class: Muzar\BazaarBundle\Entity\ItemService
        arguments: [@doctrine.orm.entity_manager, @fos_elastica.manager, @muzar_bazaar.model_service.category]

    muzar_bazaar.model_service.category:
        class: Muzar\BazaarBundle\Entity\CategoryService
        arguments: [@doctrine.orm.entity_manager, @fos_elastica.manager, @muzar_bazaar.nsm.category]


    muzar_bazaar.controller.item:
        class: Muzar\BazaarBundle\Controller\ItemController
        arguments: [@router, @form.factory, @doctrine.orm.entity_manager, @muzar_bazaar.model_service.item, @muzar_bazaar.query_suggester, @security.context]

    muzar_bazaar.controller.suggestion:
        class: Muzar\BazaarBundle\Controller\SuggestionController
        arguments: [@router, @muzar_bazaar.model_service.category, @muzar_bazaar.query_suggester]
        calls:
            - [setCache, [@doctrine_cache.providers.app_cache]]


    muzar_bazaar.controller.user:
        class: Muzar\BazaarBundle\Controller\UserController
        arguments: [@router, @form.factory, @doctrine.orm.entity_manager, @fos_user.user_manager, @security.context]


    muzar_bazaar.controller.category:
        class: Muzar\BazaarBundle\Controller\CategoryController
        arguments: [@router, @doctrine.orm.entity_manager, @muzar_bazaar.model_service.category]



    muzar_bazaar.form_type.contact:
        class: Muzar\BazaarBundle\Form\ContactType




    muzar_bazaar.serializer.event_subscriber:
        class: Muzar\BazaarBundle\Serializer\EventSubscriber
        arguments: [@router]
        tags:
            - { name: jms_serializer.event_subscriber, connection: default }
